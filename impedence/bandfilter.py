import numpy as np
from scipy.signal import butter, filtfilt, iirnotch
import matplotlib.pyplot as plt

processing_band_low_Hz = {
   1,4, 8, 13, 30
}; 
#lower bound for each frequency band of interest (2D classifier only)
processing_band_high_Hz = {
     4, 8, 13, 30, 55
};  #upper bound for each frequency band of interest

class GenericButterBand:
    def __init__(self, lowcut, highcut, fs, order=4):
        nyq = 0.5 * fs
        low = lowcut / nyq
        high = highcut / nyq
        self.b, self.a = butter(order, [low, high], btype='band')

    def __call__(self, data, fs):
        return filtfilt(self.b, self.a, data)

def notch60(data, fs):
    f0 = 60.0  # Frequency to be removed from signal (Hz)
    Q = 30.0  # Quality factor
    w0 = f0 / (fs / 2)  # Normalized frequency
    b, a = iirnotch(w0, Q)
    return filtfilt(b, a, data)

def filter_multiple_bands(data, fs, lowcut, highcut):
    filtered_data = np.zeros_like(data)
    for low, high in zip(lowcut, highcut):
        band_filter = GenericButterBand(low, high, fs)
        filtered_data += band_filter(data, fs)
    return filtered_data

def filter_impedance(data_raw):
    fs = 250  # Sampling frequency (Hz)
    data_notch = notch60(data_raw, fs=fs)
    return filter_multiple_bands(data_notch, fs=fs, lowcut=processing_band_low_Hz, highcut=processing_band_high_Hz)

def show(data):
    plt.figure(figsize=(10, 6))
    plt.plot(data[0], color='blue')
    plt.title('Filtered EEG Data')
    plt.xlabel('Sample')
    plt.ylabel('Amplitude')
    plt.grid(True)
    plt.show()

def plot_frequency_spectrum(data, fs):
    # Compute the power spectral density (PSD) using FFT
    freqs = np.fft.rfftfreq(len(data), d=1/fs)
    psd = np.abs(np.fft.rfft(data))**2

    # Plot the frequency spectrum
    plt.figure(figsize=(10, 6))
    plt.plot(freqs, psd, color='blue')
    plt.title('Frequency Spectrum of Filtered EEG Data')
    plt.xlabel('Frequency (Hz)')
    plt.ylabel('Power (microvolts^2 / Hz)')
    plt.grid(True)
    plt.show()

def get_z(rms):
    z = (1e-6 * rms * np.sqrt(2) / 6e-9) - 2200
    if z < 0:
        return 0
    return z

# Example usage
data_raw= [
    -5108.807699999999,
    -5502.90525,
    -5196.97845,
    -4759.477199999999,
    -5077.89765,
    -5538.9558,
    -5170.091399999999,
    -5083.3287,
    -5532.6530999999995,
    -5190.988649999999,
    -4749.4644,
    -5124.162149999999,
    -5512.9851,
    -5200.7555999999995,
    -4751.4758999999995,
    -5110.57335,
    -5535.1339499999995,
    -5178.3385499999995,
    -4786.341899999999,
    -5087.150549999999,
    -5530.2616499999995,
    -4686.0797999999995,
    -5020.5698999999995,
    -5416.880099999999,
    -5133.370349999999,
    -4689.1641,
    -5051.9046,
    -5492.6019,
    -5186.987999999999,
    -4767.053849999999,
    -5076.4002,
    -5542.4424,
    -5176.9752,
    -4757.5551,
    -5110.5509999999995,
    -5195.3916,
    -4739.563349999999,
    -5122.4859,
    -5520.271199999999,
    -5190.2064,
    -4789.8285,
    -5096.0458499999995,
    -5558.623799999999,
    -5185.043549999999,
    -4792.488149999999,
    -5112.339,
    -5535.8938499999995,
    -5219.037899999999,
    -4756.9293,
    -5514.0579,
    -5213.78565,
    -4774.742249999999,
    -5114.3952,
    -5571.944399999999,
    -5209.2486,
    -4816.983749999999,
    -5120.697899999999,
    -5581.353749999999,
    -5231.12925,
    -4795.34895,
    -5162.514749999999,
    -5550.5778,
    -5243.511149999999,
    -5122.4635499999995,
    -5514.8178,
    -5154.69225,
    -4737.77535,
    -5001.9747,
    -5454.539849999999,
    -5115.177449999999,
    -4743.988649999999,
    -5075.1039,
    -5478.499049999999,
    -5173.756799999999,
    -4714.3749,
    -5078.5010999999995,
    -5497.965899999999,
    -4730.1093,
    -5049.669599999999,
    -5505.81075,
    -5137.0134,
    -4737.171899999999,
    -5065.918049999999,
    -5473.8502499999995,
    -5163.40875,
    -4715.626499999999,
    -5082.68055,
    -5481.091649999999,
    -5164.16865,
    -4734.37815,
    -5048.21685,
    -5136.968699999999,
    -4744.1451,
    -5051.0553,
    -5491.707899999999,
    -5160.8385,
    -4713.95025,
    -5086.34595,
    -5479.08015,
    -5175.924749999999,
    -4714.531349999999,
    -5068.06365,
    -5493.4511999999995,
    -5138.466149999999,
    -4741.44075,
    -5501.83245,
    -5134.577249999999,
    -4721.4821999999995,
    -5067.102599999999,
    -5468.3297999999995,
    -5168.1693,
    -4716.7887,
    -5151.83145,
    -5552.7904499999995,
    -5223.5526,
    -4804.087799999999,
    -5099.5100999999995,
    -5553.2598,
    -5193.2907,
    -5100.73935,
    -5527.087949999999,
    -5205.6278999999995,
    -4746.246,
    -5117.3007,
    -5520.382949999999,
    -5185.84815,
    -4753.6438499999995,
    -5090.9724,
    -5537.2125,
    -5165.7778499999995,
    -4772.0826,
    -5092.15695,
    -5516.605799999999,
    -4757.510399999999,
    -5115.1551,
    -5504.7603,
    -5203.72815,
    -4756.862249999999,
    -5085.965999999999,
    -5532.04965,
    -5134.71135,
    -4727.203799999999,
    -5030.5827,
    -5489.80815,
    -5144.81355,
    -4707.5358,
    -5074.2099,
    -5173.60035,
    -4717.235699999999,
    -5089.34085,
    -5510.861849999999,
    -5172.84045,
    -4771.166249999999,
    -5067.03555,
    -5538.9334499999995,
    -5158.8493499999995,
    -4762.1592,
    -5094.25785,
    -5499.3516,
    -5197.9842,
    -4733.9982,
    -5524.04835,
    -5217.0264,
    -4779.56985,
    -5100.6946499999995,
    -5556.455849999999,
    -5187.90435,
    -4785.0903,
    -5104.40475,
    -5550.77895,
    -5213.9644499999995,
    -4768.39485,
    -5138.64495,
    -5528.5407,
    -5205.8961,
    -5114.9316,
    -5547.873449999999,
    -5188.6419,
    -4796.3099999999995,
    -5103.5778,
    -5545.839599999999,
    -5216.199449999999,
    -4774.205849999999,
    -5117.5242,
    -5510.303099999999,
    -5202.87885,
    -4733.21595,
    -5064.48765,
    -5463.07755,
    -4623.0975,
    -4950.77085,
    -5420.6349,
    -5061.4257,
    -4665.383699999999,
    -5018.13375,
    -5417.081249999999,
    -5126.017199999999,
    -4678.54785,
    -5056.12875,
    -5454.226949999999,
    -5119.8039,
    -4704.5409,
    -5010.84765,
    -5106.304499999999,
    -4718.8002,
    -5029.956899999999,
    -5457.244199999999,
    -5141.9751,
    -4682.97315,
    -5051.34585,
    -5444.3259,
    -5137.9520999999995,
    -4693.9917,
    -5037.0642,
    -5465.4019499999995,
    -5098.079699999999,
    -4708.5639,
    -5475.9064499999995,
    -5116.496099999999,
    -4691.64495,
    -5044.32795,
    -5441.867399999999,
    -5138.801399999999,
    -4695.735,
    -5044.372649999999,
    -5460.954299999999,
    -5115.22215,
    -4708.4968499999995,
    -5012.6133,
    -5465.89365,
    -5113.4118,
    -5026.6491,
    -5443.05195,
    -5135.6723999999995,
    -4671.015899999999,
    -5037.48885,
    -5448.0806999999995,
    -5107.35495,
    -4679.75475,
    -5006.02005,
    -5453.19885,
    -5090.2572,
    -4685.4316499999995,
    -5015.4294,
    -5432.81565,
    -4665.048449999999,
    -5023.587149999999,
    -5419.9644,
    -5104.74,
    -4676.5587,
    -4990.82205,
    -5450.315699999999,
    -5120.2955999999995,
    -4725.7734,
    -5032.683599999999,
    -5476.8228,
    -5137.281599999999,
    -4691.376749999999,
    -5062.52085,
    -5143.60665,
    -4683.3978,
    -5039.45565,
    -5461.2895499999995,
    -5108.695949999999,
    -4713.883199999999,
    -5015.250599999999,
    -5470.140149999999,
    -5102.415599999999,
    -4690.6392,
    -5031.99075,
    -5436.034049999999,
    -5129.97315,
    -4668.959699999999,
    -5425.6636499999995,
    -5104.1142,
    -4686.3033,
    -5000.6784,
    -5462.675249999999,
    -5097.2303999999995,
    -4683.1519499999995,
    -5004.2544,
    -5438.89485,
    -5110.863899999999,
    -4656.77895,
    -5028.347699999999,
    -5424.2109,
    -5098.6384499999995,
    -4812.8043,
    -5207.460599999999,
    -4806.1663499999995,
    -4388.53425,
    -4684.001249999999,
    -5117.7029999999995,
    -4807.06035,
    -4565.0769,
    -4929.53835,
    -5328.307049999999,
    -5033.46585,
    -4587.3375,
    -4931.95215,
    -5385.478349999999,
    -4649.8281,
    -4953.2517,
    -5411.6502,
    -5059.324799999999,
    -4633.222049999999,
    -4987.38015,
    -5390.015399999999,
    -5082.7476,
    -4621.60005,
    -4996.0296,
    -5404.4982,
    -5068.2201,
    -4660.422,
    -4967.801549999999,
    -5089.8102,
    -4694.9527499999995,
    -5016.3681,
    -5437.017449999999,
    -5123.9833499999995,
    -4663.88625,
    -5038.941599999999,
    -5433.8884499999995,
    -5130.353099999999,
    -4689.00765,
    -5015.027099999999,
    -5470.22955,
    -5102.7732,
    -4704.473849999999,
    -5475.772349999999,
    -5131.425899999999,
    -4695.153899999999,
    -5062.8561,
    -5454.3834,
    -5148.70245,
    -4724.9688,
    -5074.5228,
    -5488.42245,
    -5142.08685,
    -4738.9599,
    -5043.97035,
    -5492.758349999999,
    -5152.4572499999995,
    -5062.0962,
    -5468.88855,
    -5160.19035,
    -4701.47895,
    -5064.8676,
    -5480.756399999999,
    -5132.65515,
    -4718.3979,
    -5037.80175,
    -5494.4346,
    -5124.832649999999,
    -4719.13545,
    -5054.5866,
    -5463.9938999999995,
    -4681.14045,
    -5048.57445,
    -5438.648999999999,
    -5118.529949999999,
    -4688.7171,
    -5005.9977,
    -5460.12735,
    -5166.180149999999,
    -4781.17905,
    -5095.6659,
    -5536.1397,
    -5200.6662,
    -4747.96695,
    -5117.345399999999,
    -5198.766449999999,
    -4740.7032,
    -5087.9775,
    -5518.326749999999,
    -5158.9164,
    -4767.00915,
    -5072.623049999999,
    -5517.790349999999,
    -5158.6929,
    -4737.909449999999,
    -5090.1231,
    -5481.605699999999,
    -5181.4899,
    -4725.1029,
    -5499.46335,
    -5164.7274,
    -4747.6317,
    -5056.66515,
    -5522.327399999999,
    -5153.17245,
    -4723.0467,
    -5041.556549999999,
    -5470.63185,
    -5142.9585,
    -4687.666649999999,
    -5056.66515,
    -5461.7589,
    -5134.8678,
    -5009.193749999999,
    -5450.852099999999,
    -5096.6046,
    -4702.01535,
    -5022.87195,
    -5455.634999999999,
    -5132.0517,
    -4684.6941,
    -5038.24875,
    -5441.1521999999995,
    -5137.5498,
    -4685.38695,
    -5027.56545,
    -5470.00605,
    -4701.70245,
    -5014.7589,
    -5471.1458999999995,
    -5116.02675,
    -4687.688999999999,
    -5044.462049999999,
    -5442.113249999999,
    -5137.34865,
    -4678.1678999999995,
    -5040.4167,
    -5451.45555,
    -5115.177449999999,
    -4713.59265,
    -5028.32535,
    -5132.7669,
    -4733.97585,
    -5056.3299,
    -5472.9785999999995,
    -5163.45345,
    -4702.7082,
    -5064.711149999999,
    -5464.55265,
    -5153.9994,
    -4713.5256,
    -5044.2162,
    -5496.468449999999,
    -5130.86715,
    -4726.0416,
    -5497.630649999999,
    -5148.56835,
    -4709.52495,
    -5076.02025,
    -5473.8502499999995,
    -5167.6329,
    -4725.2817,
    -5017.418549999999,
    -5431.273499999999,
    -5078.813999999999,
    -4680.3582,
    -4992.34185,
    -5445.7116,
    -5110.193399999999,
    -5025.59865,
    -5435.3412,
    -5132.69985,
    -4669.2279,
    -5032.124849999999,
    -5456.7525,
    -5105.4105,
    -4691.95785,
    -5014.446,
    -5473.380899999999,
    -5121.569549999999,
    -4719.98475,
    -5063.7724499999995,
    -5469.96135,
    -4703.602199999999,
    -5080.736099999999,
    -5474.811299999999,
    -5151.674999999999,
    -4729.2823499999995,
    -5038.82985,
    -5502.7935,
    -5136.90165,
    -4739.6750999999995,
    -5051.34585,
    -5482.924349999999,
    -5159.20695,
    -4705.0326,
    -5077.54005,
    -5170.8066,
    -4722.30915,
    -5065.8957,
    -5502.7935,
    -5137.3039499999995,
    -4738.132949999999,
    -5061.9621,
    -5503.620449999999,
    -5147.62965,
    -4720.9905,
    -5076.646049999999,
    -5474.788949999999,
    -5168.50455,
    -4723.82895,
    -5484.9582,
    -5147.897849999999,
    -4740.3232499999995,
    -5043.5457,
    -5504.51445,
    -5153.1501,
    -4718.1296999999995,
    -5057.9391,
    -5472.218699999999,
    -5162.1348,
    -4701.4119,
    -5063.0796,
    -5481.35985,
    -5137.52745,
    -5039.5226999999995,
    -5495.574449999999,
    -5127.626399999999,
    -4727.740199999999,
    -5055.99465,
    -5472.37515,
    -5157.865949999999,
    -4709.457899999999,
    -5073.56175,
    -5468.955599999999,
    -5154.1335,
    -4720.9011,
    -5052.820949999999,
    -5500.6479,
    -4739.25045,
    -5040.0590999999995,
    -5492.9148,
    -5151.6303,
    -4709.39085,
    -5075.662649999999,
    -5470.5201,
    -5166.1131,
    -4705.94895,
    -5064.8676,
    -5488.1766,
    -5134.890149999999,
    -4732.299599999999,
    -5037.80175,
    -4828.06935,
    -4408.9398,
    -4748.860949999999,
    -5154.2229,
    -4855.939799999999,
    -4421.3216999999995,
    -4791.191849999999,
    -5330.8102499999995,
    -5018.066699999999,
    -4600.7922,
    -4917.670499999999,
    -5379.086249999999,
    -5032.52715,
    -4619.9685,
    -5412.9911999999995,
    -5091.7099499999995,
    -4630.942349999999,
    -5011.96515,
    -5416.120199999999,
    -5081.4289499999995,
    -4656.0860999999995,
    -5006.3106,
    -5439.386549999999,
    -5074.99215,
    -4680.60405,
    -4990.0845,
    -5427.3399,
    -5088.4692,
    -5004.36615,
    -5407.2696,
    -5094.391949999999,
    -4642.966649999999,
    -4992.297149999999,
    -5421.081899999999,
    -5072.086649999999,
    -4670.41245,
    -4973.456099999999,
    -5439.34185,
    -5087.6646,
    -4655.25915,
    -5011.60755,
    -5416.768349999999,
    -4661.02545,
    -5028.571199999999,
    -5436.1905,
    -5109.8358,
    -4695.489149999999,
    -5003.650949999999,
    -5454.40575,
    -5089.47495,
    -4692.27075,
    -4985.033399999999,
    -5410.8232499999995,
    -5102.88495,
    -4644.464099999999,
    -5016.30105,
    -5121.97185,
    -4670.0548499999995,
    -5000.5443,
    -5461.1777999999995,
    -5112.98715,
    -4640.575199999999,
    -5013.26145,
    -5461.468349999999,
    -5057.73795,
    -4665.6519,
    -5037.1536,
    -5446.80675,
    -5142.6008999999995,
    -4705.993649999999,
    -5487.684899999999,
    -5157.3966,
    -4741.1948999999995,
    -5059.61535,
    -5514.48255,
    -5159.676299999999,
    -4738.62465,
    -5053.4914499999995,
    -5480.3988,
    -5162.604149999999,
    -4705.0773,
    -5067.3484499999995,
    -5477.02395,
    -5137.9968,
    -5018.491349999999,
    -5467.972199999999,
    -5187.01035,
    -4681.81095,
    -5111.64615,
    -5494.389899999999,
    -5155.139249999999,
    -4786.3866,
    -5083.39575,
    -5510.861849999999,
    -5203.28115,
    -4713.4362,
    -5130.3084,
    -5501.5866,
    -4591.38285,
    -4860.87915,
    -5350.7688,
    -4842.8874,
    -4528.713449999999,
    -4807.485,
    -5189.9829,
    -4993.8393,
    -4563.802949999999,
    -4963.3092,
    -5311.2092999999995,
    -5066.789699999999,
    -4608.0336,
    -4942.054349999999,
    -5067.25905,
    -4651.035,
    -4952.111849999999,
    -5424.121499999999,
    -5062.8114,
    -4636.3287,
    -5001.95235,
    -5419.025699999999,
    -5119.423949999999,
    -4625.1089999999995,
    -5014.0884,
    -5422.2441,
    -5072.310149999999,
    -4693.4553,
    -5309.39895,
    -4866.0867,
    -4459.406099999999,
    -4765.467,
    -5171.499449999999,
    -4852.56495,
    -4371.9729,
    -5033.3988,
    -5391.646949999999,
    -5119.5804,
    -4703.2446,
    -4998.59985,
    -5502.614699999999,
    -5087.754,
    -5015.94345,
    -5488.757699999999,
    -5176.2823499999995,
    -4690.9520999999995,
    -5115.512699999999,
    -5454.6069,
    -5161.084349999999,
    -4739.96565,
    -5114.0152499999995,
    -5557.39455,
    -5183.92605,
    -4804.33365,
    -5084.6696999999995,
    -5543.8281,
    -4775.99385,
    -5096.112899999999,
    -5533.9941,
    -5202.65535,
    -4744.61445,
    -5110.6851,
    -5519.71245,
    -5194.4752499999995,
    -4743.09465,
    -5100.135899999999,
    -5531.2450499999995,
    -5161.732499999999,
    -4763.142599999999,
    -5079.50685,
    -5171.32065,
    -4732.8583499999995,
    -5099.063099999999,
    -5481.605699999999,
    -5167.96815,
    -4742.4018,
    -5066.8344,
    -5504.022749999999,
    -5168.72805,
    -4760.013599999999,
    -5073.78525,
    -5515.7118,
    -5170.60545,
    -4750.02315,
    -5512.56045,
    -5180.148899999999,
    -4739.83155,
    -5087.3964,
    -5491.1714999999995,
    -5175.500099999999,
    -4750.9842,
    -5074.701599999999,
    -5512.3146,
    -5153.507699999999,
    -4748.19045,
    -5070.96915,
    -5499.8432999999995,
    -5179.90305,
    -5088.58095,
    -5485.4499,
    -5172.2817,
    -4728.6341999999995,
    -5068.8682499999995,
    -5508.62685,
    -5152.90425,
    -4745.508449999999,
    -5060.1294,
    -5512.359299999999,
    -5152.881899999999,
    -4734.28875,
    -5093.14035,
    -5488.0872,
    -4719.00135,
    -5091.97815,
    -5478.432,
    -5152.323149999999,
    -4741.9101,
    -5052.932699999999,
    -5510.213699999999,
    -5143.5842999999995,
    -4746.62595,
    -5056.12875,
    -5471.52585,
    -5160.883199999999,
    -4708.63095,
    -5078.6352,
    -5168.41515,
    -4720.96815,
    -5052.485699999999,
    -5501.38545,
    -5139.874199999999,
    -4742.51355,
    -5056.12875,
    -5494.389899999999,
    -5143.874849999999,
    -4703.31165,
    -5067.2814,
    -5466.38535,
    -5163.475799999999,
    -4714.1514,
    -5474.3196,
    -5125.99485,
    -4719.828299999999,
    -5031.499049999999,
    -5489.18235,
    -5138.19795,
    -4691.577899999999,
    -5058.0732,
    -5467.5252,
    -5158.9164,
    -4701.3448499999995,
    -5070.52215,
    -5482.87965,
    -5131.4482499999995,
    -5042.2941,
    -5500.0668,
    -5129.4591,
    -4738.468199999999,
    -5470.5201,
    -5161.955999999999,
    -4701.3448499999995,
    -5071.349099999999,
    -5463.435149999999,
    -5149.1047499999995,
    -4724.4100499999995,
    -5037.645299999999,
    -5491.8196499999995,
    -4736.0544,
    -5042.8305,
    -5493.60765,
    -5149.81995,
    -4681.7438999999995,
    -5043.47865,
    -5427.2058,
    -5136.8793,
    -4677.2292,
    -5039.7909,
    -5472.3528,
    -5114.50695,
    -4720.9457999999995,
    -5018.938349999999,
    -5114.68575,
    -4711.402349999999,
    -5054.92185,
    -5451.5449499999995,
    -5154.178199999999,
    -4687.241999999999,
    -5047.412249999999,
    -5448.41595,
    -5132.9904,
    -4714.978349999999,
    -5027.476049999999,
    -5492.26665,
    -5119.7591999999995,
    -4710.06135,
    -5472.01755,
    -5149.14945,
    -4691.95785,
    -5067.2814,
    -5457.40065,
    -5137.0134,
    -4721.19165,
    -5059.48125,
    -5502.81585,
    -5138.9355,
    -4754.67195,
    -5049.0437999999995,
    -5488.4671499999995,
    -5173.332149999999,
    -5077.36125,
    -5469.3579,
    -5179.2101999999995,
    -4712.56455,
    -5055.949949999999,
    -5505.2073,
    -5136.298199999999,
    -4738.98225,
    -5044.2162,
    -5507.68815,
    -5140.209449999999,
    -4711.625849999999,
    -5076.28845,
    -5470.6542,
    -4704.1833,
    -5085.8766,
    -5483.0584499999995,
    -5139.673049999999,
    -4738.356449999999,
    -5042.092949999999,
    -5509.6326,
    -5131.8282,
    -4751.09595,
    -5066.990849999999,
    -5477.64975,
    -5169.130349999999,
    -4706.26185,
    -5090.838299999999,
    -5177.1539999999995,
    -4722.04095,
    -5051.34585,
    -5509.43145,
    -5133.370349999999,
    -4753.7109,
    -5066.454449999999,
    -5513.4767999999995,
    -5156.5026,
    -4713.63735,
    -5087.999849999999,
    -5466.474749999999,
    -5181.2663999999995,
    -4730.980949999999,
    -5494.0323,
    -5139.9636,
    -4755.9906,
    -5037.757049999999,
    -5512.4487,
    -5157.418949999999,
    -4709.5696499999995,
    -5070.52215,
    -5480.82345,
    -5179.187849999999,
    -4702.77525,
    -5087.6199,
    -5501.47485,
    -5140.432949999999,
    -5050.63065,
    -5509.878449999999,
    -5132.4316499999995,
    -4738.2894,
    -5075.26035,
    -5473.492649999999,
    -5178.427949999999,
    -4702.59645,
    -5083.44045,
    -5458.004099999999,
    -5160.436199999999,
    -4736.4343499999995,
    -5053.022099999999,
    -5526.015149999999,
    -4768.9536,
    -5056.8663,
    -5512.694549999999,
    -5183.7696,
    -4724.2089,
    -5109.7017,
    -5479.907099999999,
    -5194.43055,
    -4714.5984,
    -5082.0324,
    -5516.31525,
    -5146.0875,
    -4774.0046999999995,
    -5050.854149999999,
    -5132.02935,
    -4728.0084,
    -5077.2047999999995,
    -5470.4307,
    -5186.987999999999,
    -4708.161599999999,
    -5064.75585,
    -5473.53735,
    -5151.8090999999995,
    -4741.172549999999,
    -5043.724499999999,
    -5517.321,
    -5135.69475,
    -4720.5435,
    -5483.4384,
    -5168.3034,
    -4697.27715,
    -5089.519649999999,
    -5467.346399999999,
    -5140.38825,
    -4733.88645,
    -5054.60895,
    -5504.0898,
    -5129.481449999999,
    -4753.9791,
    -5045.132549999999,
    -5472.620999999999,
    -5160.3691499999995,
    -5072.2878,
    -5453.1765,
    -5173.443899999999,
    -4708.1169,
    -5043.21045,
    -5496.06615,
    -5117.3901,
    -4753.532099999999,
    -5044.8867,
    -5524.942349999999,
    -5159.028149999999,
    -4721.10225,
    -5090.45835,
    -5467.3911,
    -4702.954049999999,
    -5089.989,
    -5489.607,
    -5138.51085,
    -4746.357749999999,
    -5032.8624,
    -5511.1524,
    -5125.23495,
    -4745.6649,
    -5060.732849999999,
    -5467.36875,
    -5168.4821999999995,
    -4690.12515,
    -5079.5292,
    -5167.1858999999995,
    -4722.443249999999,
    -5038.963949999999,
    -5505.564899999999,
    -5114.4846,
    -4737.7306499999995,
    -5055.4806,
    -5496.6249,
    -5150.44575,
    -4696.986599999999,
    -5074.50045,
    -5447.074949999999,
    -5155.161599999999,
    -4721.7056999999995,
    -5482.164449999999,
    -5125.1678999999995,
    -4745.284949999999,
    -5028.8394,
    -5493.7194,
    -5157.46365,
    -4700.2944,
    -5057.8497,
    -5452.483649999999,
    -5162.02305,
    -4673.98845,
    -5058.72135,
    -5491.149149999999,
    -5121.793049999999,
    -5035.5444,
    -5511.66645,
    -5113.121249999999,
    -4718.330849999999,
    -5065.4039999999995,
    -5454.875099999999,
    -5176.63995,
    -4690.75095,
    -5087.10585,
    -5454.450449999999,
    -5149.68585,
    -4733.5512,
    -5030.6721,
   
  
]
data_filtered = filter_impedance(data_raw)
stdUv = np.std(data_filtered)
print("Standard deviation of microvolts:", stdUv)
z = get_z(stdUv)
impedance = (np.sqrt(2.0) * (stdUv) * 1.0**(-6) / 6.0**(-9)) - 2200
print("impedance: ", z)
print(f'For {stdUv:.2f} uVrms the electrode-to-head impedance is {(z)/1000:.2f} KOhm')

show([data_filtered])
plot_frequency_spectrum(data_filtered, fs=250)

